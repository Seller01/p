<template>
    <div v-if="!showZero">
        <b>{{time}}</b>
    </div>
</template>

<script>
import countdown from 'countdown';
import { leftPad } from "./util";
export default {
    props: {
        endDateMs: {
            default: moment().valueOf()
        },
        units: {
            default: countdown.MINUTES | countdown.SECONDS
        }
    },
    data() {
        return {
            minutes: 0,
            seconds: 0,
            showZero: false
        };
    },
    mounted() {
        setInterval(() => {
            var now = moment().valueOf();
            var timespan = countdown(now, this.endDateMs, this.units);
            this.minutes = timespan.minutes;
            this.seconds = timespan.seconds;
            this.showZero = now >= this.endDateMs;
            if (this.showZero) {
                this.$emit('done');
            }
        }, 1000);
    },
    computed: {
        time() {
            return leftPad(this.minutes, 2) + ':' + leftPad(this.seconds, 2);
        }
    }
}
</script>